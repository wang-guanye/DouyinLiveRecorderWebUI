# 直播录制工具 Web 端 PRD 文档（V1.0）
## 文档说明
本文档基于 `DouyinLiveRecorder-main` 项目，结合用户需求明确 Web 端的核心功能、交互逻辑、部署要求等，为开发团队提供可落地的开发依据。文档聚焦“小团队远程管理抖音直播录制”核心场景，仅保留必要功能，遵循极简设计原则。

## 一、基础信息
### 1. 产品核心目标
- 核心价值：支持小团队通过浏览器远程管理服务器上的抖音直播录制任务，无需命令行操作，实现“添加直播间后自动监控、开播即录”。
- 核心目标：远程管理 > 自动化录制 > 极简操作 > 移动端适配

### 2. 目标用户与使用场景
- 目标用户：3-10人小团队（如内容运营团队、自媒体团队）
- 典型场景：
  1. 团队成员在办公室/家中，通过浏览器访问服务器部署的 Web 端，输入抖音号添加直播间；
  2. Web 端自动监控直播间状态，开播后触发录制，团队成员可实时查看录制进度；
  3. 录制完成后，团队成员通过 Web 端下载/删除录制文件，或处理录制异常（如风控拦截）。

### 3. 部署与访问要求
- 部署方式：Web 端独立部署（作为单独服务），通过接口调用 `DouyinLiveRecorder-main` 核心功能；
- 访问范围：支持局域网/公网访问（通过服务器 IP+端口访问，如 `http://xxx.xxx.xxx.xxx:5000`）；
- 容器支持：必须支持 Docker 部署（Web 端可与原项目共用一个容器，或单独容器，需兼容原项目运行环境）；
- 兼容性：支持 Chrome、Edge、Safari 浏览器，需适配手机端浏览器。

## 二、核心功能模块
### 模块1：直播间管理（V1.0 仅支持抖音平台）
#### 1.1 核心功能描述
| 功能点                | 详细说明                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| 单个添加直播间        | 仅需输入「抖音号」，Web 端自动抓取直播间信息（主播名、直播间链接），无需手动输入其他字段； |
| 批量添加直播间        | 支持批量输入多个抖音号（换行分隔），批量抓取信息并添加，自动去重（按直播间链接去重）；   |
| 编辑直播间            | 可修改「录制画质」（仅支持 1080p/原画，默认 1080p）、「启用状态」（启用/禁用录制）；     |
| 批量操作              | 支持批量删除直播间、批量启用/禁用直播间录制；                                 |
| 直播间分组            | 支持按「平台（默认抖音）」「主播名」「自定义分组」（用户可创建分组并归类直播间）；       |
| 自动监控与录制        | 添加直播间后默认启用「自动监控」，监测到直播间开播后自动启动录制，下播后自动停止；       |
| 直播间列表展示        | 显示字段：序号、直播间名称（主播名）、录制画质、录制状态、启用状态、添加时间、最近录制时间、历史录制文件数； |

#### 1.2 交互逻辑
- 添加直播间：输入抖音号 → 点击“添加” → 顶部弹出“添加成功”/“已存在该直播间”通知 → 列表实时刷新；
- 批量添加：粘贴多个抖音号 → 点击“批量添加” → 显示加载动画 → 完成后通知“成功添加X个，重复X个”；
- 编辑操作：点击列表“编辑”按钮 → 弹出极简编辑框（仅显示可修改字段） → 保存后即时生效；
- 分组操作：创建分组 → 勾选直播间 → 选择“移动到分组” → 分组列表同步更新；
- 状态标识：录制状态分为“未录制”（灰色）、“录制中”（绿色）、“异常”（红色）、“已停止”（黑色）；

#### 1.3 约束条件
- 仅支持抖音平台，无需提供其他平台选择；
- 录制画质仅支持 1080p（默认）和原画，跟随原项目核心能力；
- 重复添加校验：按直播间链接去重，同一直播间无法重复添加；
- 禁用直播间后，自动监控停止，已启动的录制任务不受影响（需手动停止）。

### 模块2：录制控制
#### 2.1 核心功能描述
| 功能点                | 详细说明                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| 单个录制控制          | 支持启动/停止单个直播间录制（禁用状态下无法启动）；                           |
| 批量录制控制          | 支持启动全部已启用直播间录制、停止全部正在录制的直播间；                       |
| 录制状态实时更新      | 每 3 秒自动刷新录制状态，无需手动刷新；                                       |
| 异常处理              | 录制异常时（如链接无效、风控拦截、服务器错误），列表状态标红，显示异常原因（截取核心错误信息），提供“一键重试”按钮； |
| 自动重启录制          | 录制任务意外终止（非用户主动停止）时，自动重试 3 次（每次间隔 10 秒），重试失败则标记为“异常”； |

#### 2.2 交互逻辑
- 启动/停止录制：点击列表“启动”/“停止”按钮 → 按钮状态切换（如“启动”变“停止中”） → 顶部通知操作结果；
- 批量启停：点击“启动全部”/“停止全部” → 显示加载动画 → 完成后通知“成功启动X个”/“成功停止X个”；
- 异常处理：状态标红 + 显示“异常：XXX” → 点击“一键重试” → 状态变为“重试中” → 成功则恢复“录制中”，失败则保持“异常”；

### 模块3：参数配置
#### 3.1 核心功能描述
| 功能点                | 详细说明                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| 核心参数配置          | 仅保留原项目必要参数（排除消息推送功能），支持配置：分段录制（启用/禁用）、强制转码（启用/禁用）、录制文件存储路径（只读，沿用原项目路径）； |
| 配置生效规则          | 修改配置后即时生效，无需重启 Web 服务或录制任务；                             |
| 配置历史与回滚        | 保存每次配置修改记录（修改时间、修改内容），支持回滚到历史配置版本；             |

#### 3.2 交互逻辑
- 配置页面：极简布局，仅显示可配置项（开关/输入框） → 点击“保存配置” → 顶部通知“配置保存成功”；
- 配置回滚：查看配置历史列表 → 选择某版本 → 点击“回滚” → 二次确认 → 回滚后通知生效；

#### 3.3 约束条件
- 录制文件存储路径仅支持查看，不允许通过 Web 端修改（沿用原项目 `downloads` 目录）；
- 配置历史最多保存最近 10 个版本，超出自动删除最早版本；
- 排除所有消息推送相关配置（用户明确要求）。

### 模块4：录制文件管理
#### 4.1 核心功能描述
| 功能点                | 详细说明                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| 文件列表查看          | 按「直播间」分组展示录制文件，每组下显示该直播间的所有录制文件；               |
| 文件操作              | 支持单个文件下载、批量文件下载；支持单个文件删除、批量文件删除（删除前二次确认）； |
| 分页展示              | 每页默认显示 20 个文件，支持分页切换；                                       |
| 在线预览（暂不支持）  | V1.0 不支持视频在线播放，仅提供文件信息展示（名称、大小、录制时间）；           |

#### 4.2 交互逻辑
- 文件列表：默认按录制时间倒序排列（最新文件在前），显示字段：文件名、文件大小（MB）、录制时间；
- 下载操作：单个文件点击“下载” → 直接触发下载；批量下载勾选文件 → 点击“批量下载” → 打包为压缩包下载；
- 删除操作：单个文件点击“删除” → 弹出“确定删除该文件？删除后不可恢复” → 确认后删除；批量删除同理；
- 分组切换：点击左侧直播间分组 → 右侧显示该分组下所有直播间的录制文件；

### 模块5：日志查看
#### 5.1 核心功能描述
| 功能点                | 详细说明                                                                 |
|-----------------------|--------------------------------------------------------------------------|
| 实时日志展示          | 显示原项目录制相关日志，每 5 秒自动刷新，默认显示最近 1000 行；               |
| 日志约束              | 不支持筛选、搜索、导出、清空功能，仅提供基础查看；                           |

#### 5.2 交互逻辑
- 日志页面：极简文本展示区，自动滚动到最新日志行；
- 日志加载：首次进入加载最近 1000 行，后续每 5 秒增量更新新增日志；
- 性能约束：日志最大加载行数 1 万行，超出后自动清除最早日志（仅前端展示层面，不影响原项目日志文件）。

### 模块6：权限与访问控制
#### 6.1 核心规则
- 无多用户管理：仅支持单用户操作，无需账号密码登录；
- 无 IP 限制：允许任何可访问服务器 IP 的设备访问 Web 端（用户自行通过服务器防火墙控制访问范围）；
- 数据安全：录制文件、配置信息无需加密存储，沿用原项目存储逻辑。

## 三、交互与体验需求
### 1. 操作反馈
- 所有操作（添加、启停、保存配置等）均通过「顶部通知」反馈结果，通知自动消失（3秒后）；
- 长时间操作（批量添加10+直播间、批量下载文件）需显示「加载动画」（极简风格，无多余装饰）；
- 错误提示需明确（如“添加失败：抖音号无效”“删除失败：文件正在被使用”），避免模糊表述。

### 2. 界面风格
- 整体风格：极简风格，无多余色彩和装饰，以白/灰为基调，核心操作按钮用深色突出；
- 响应式设计：适配电脑端（最小宽度 1280px）和手机端（最小宽度 375px），手机端采用流式布局，关键功能优先展示；
- 导航设计：顶部固定导航栏（首页、文件管理、配置、日志），手机端折叠为下拉菜单。

### 3. 异常处理
- Web 服务断开：页面显示“连接已断开，正在重试...”（居中提示），每 5 秒自动重试连接，连接成功后自动刷新页面；
- 录制异常：除列表标红和显示原因外，无需额外弹窗干扰，仅提供“一键重试”入口；
- 文件操作异常：删除/下载失败时，顶部通知错误原因，不阻断其他操作。

## 四、非功能需求
### 1. 性能要求
- 直播间管理：支持同时管理最多 50 个直播间，列表刷新无卡顿；
- 日志加载：支持最大 1 万行日志加载，滚动无卡顿；
- 文件管理：支持单页 20 个文件展示，批量下载（最大 10 个文件打包）无超时（超时阈值 30 秒）。

### 2. 兼容性要求
- 浏览器支持：Chrome（版本 90+）、Edge（版本 90+）、Safari（版本 14+）；
- 移动端适配：支持 iOS Safari、Android Chrome 浏览器，核心功能（添加直播间、启停录制、下载文件）正常使用。

### 3. 稳定性要求
- Web 服务：支持 7x24 小时运行，无内存泄漏；
- 接口调用：与原项目核心接口交互成功率 ≥ 99%，失败时提供重试机制；
- 数据一致性：直播间状态、录制状态、文件列表与原项目实际状态一致（延迟不超过 3 秒）。

## 五、开发优先级
### V1.0 必需功能（核心落地）
1. 直播间管理：单个/批量添加抖音直播间、编辑、删除、分组；
2. 录制控制：单个/批量启停录制、自动监控与录制、异常处理（标红+重试）；
3. 文件管理：按直播间分组查看文件、单个/批量下载、删除（二次确认）；
4. 基础配置：核心参数配置（分段录制、强制转码）、配置回滚；
5. 日志查看：实时日志展示（1000行）；
6. 交互基础：顶部通知、加载动画、移动端适配、断开重连。

### 后续迭代功能（V1.1+）
1. 直播间搜索/筛选（按主播名、状态）；
2. 录制文件筛选（按时间、大小）；
3. 日志筛选/搜索/导出；
4. 多平台支持（如 TikTok、快手，根据需求扩展）；
5. 录制统计（如总录制时长、文件总数）。

## 六、附录
### 1. 术语说明
- 抖音号：指直播间主播的抖音 ID（如“xxx123”），Web 端通过该 ID 自动抓取直播间链接和主播名；
- 自动监控：Web 端定期（每 30 秒）查询直播间在线状态，开播则触发录制；
- 录制异常：包括但不限于“直播间链接无效”“风控拦截无法获取流地址”“录制进程意外终止”“文件写入失败”。

### 2. 依赖说明
- 需原项目提供核心接口：直播间信息抓取接口、录制启停接口、状态查询接口、文件列表接口、日志读取接口、配置修改接口；
- Docker 部署需兼容原项目运行环境（Python 3.10+），提供统一的 `docker-compose.yaml` 文件。